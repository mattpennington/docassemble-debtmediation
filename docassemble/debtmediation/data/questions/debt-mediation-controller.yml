mandatory: True
code: |
  # set the interview as multi user (https://docassemble.org/docs/special.html#multi_user)
  multi_user = True

  role = 'organizer'
  # we pass in the user as a url query string parameter - they will authenicate with their auth code (https://docassemble.org/docs/special.html#url_args) to save requiring a login
  if 'role' in url_args:
    role = url_args['role']

  #  role = 'organizer'
  #  if intro_screen_mediator and applicant.mobile_number and debtor.mobile_number:
  #    if user_logged_in():
  #      if user_info().email == applicant.email:
  #        role = 'applicant'
  #      elif user_info().email == debtor.email:
  #        role = 'debtor'
---
event: role_event
question: Awaiting Information
subquestion: |
  role = 'organizer'
  if 'role' in url_args:
    role = url_args['role']

  % if role == 'organizer':
    % if 'applicant' in role_needed:
    We are waiting for information from the applicant and the debtor
    % elif 'debtor' in role_needed:
    We are now waiting for information from the debtor
    % endif
  % elif role == 'applicant':
    We are awaiting information from the debtor.
  % else:
    We are awaiting more information.
  % endif

  Press **Check** to refresh the status of this interview.
buttons:
  - Check: refresh
---
objects:
  - applicant: Individual
  - debtor: Individual
#---
#mandatory: True
#code: |
#  applicant.role = 'applicant'
#  debtor.role = 'debtor'
---
#we are using this code block to control the flow of the interview between the various parties
mandatory: True
code: |
  # mediator questions
  # show the mediator an intro screen
  intro_screen_mediator
  # capture the information about the applicant and the debtor
  applicant.mobile_number
  debtor.mobile_number

  applicant.sms_sent

  # applicant questions
  intro_screen_applicant
  applicant_auth_code
  applicant.debt_amount
  applicant.debt_months
  applicant.debt_overview
  applicant.debt_proposals

  debtor.sms_sent

  # debtor questions
  intro_screen_debtor
  debtor_auth_code
  debtor.debt_overview
  debtor.debt_proposals

  #update the mediator
  mediation_overview_email
---
# create a final screen for all participants
mandatory: True
role:
  - organizer
  - applicant
  - debtor
question: Interview Completed
subquestion: This interview is completed.